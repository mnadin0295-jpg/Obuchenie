# исходные данные
documents = [
    {'type': 'passport', 'number': '2207 876234', 'name': 'Василий Гупкин'},
    {'type': 'invoice', 'number': '11-2', 'name': 'Геннадий Покемонов'},
    {'type': 'insurance', 'number': '10006', 'name': 'Аристарх Павлов'}
]
directories = {
    '1': ['2207 876234', '11-2'],
    '2': ['10006'],
    '3': []
}

def find_owner(doc_number, docs):
    for doc in docs:
        if doc['number'] == doc_number:
            return doc['name']
    return None

def find_shelf(doc_number, dirs):
    for shelf, doc_numbers in dirs.items():
        if doc_number in doc_numbers:
            return shelf
    return None

def list_all_documents(docs, dirs):
    result = []
    for doc in docs:
        # ищем полку
        shelf = find_shelf(doc['number'], dirs)
        if shelf is None:
            shelf = 'неизвестно'
        line = f"№: {doc['number']}, тип: {doc['type']}, владелец: {doc['name']}, полка хранения: {shelf}"
        result.append(line)
    return result

def add_shelf(shelves):
    new_shelf = input("Введите номер полки:\n")
    if new_shelf in shelves:
        print(f"Такая полка уже существует. Текущий перечень полок: {', '.join(sorted(shelves.keys(), key=int))}.")
    else:
        shelves[new_shelf] = []
        print(f"Полка добавлена. Текущий перечень полок: {', '.join(sorted(shelves.keys(), key=int))}.")

def delete_shelf(shelves, docs):
    shelf_to_delete = input("Введите номер полки:\n")
    if shelf_to_delete not in shelves:
        print(f"Такой полки не существует. Текущий перечень полок: {', '.join(sorted(shelves.keys(), key=int))}.")
        return
    if len(shelves[shelf_to_delete]) > 0:
        print(f"На полке есть документы, удалите их перед удалением полки. Текущий перечень полок: {', '.join(sorted(shelves.keys(), key=int))}.")
        return
    # удаляем полку
    del shelves[shelf_to_delete]
    print(f"Полка удалена. Текущий перечень полок: {', '.join(sorted(shelves.keys(), key=int))}.")

def main():
    while True:
        command = input("Введите команду:\n")
        if command == 'q':
            break
        elif command == 'p':
            doc_number = input("Введите номер документа:\n")
            owner = find_owner(doc_number, documents)
            if owner:
                print(f"Результат:\nВладелец документа: {owner}")
            else:
                print("Результат:\nДокумент не найден в базе")
        elif command == 's':
            doc_number = input("Введите номер документа:\n")
            shelf = find_shelf(doc_number, directories)
            if shelf:
                print(f"Результат:\nДокумент хранится на полке: {shelf}")
            else:
                print("Результат:\nДокумент не найден в базе")
        elif command == 'l':
            print("Результат:\n")
            for line in list_all_documents(documents, directories):
                print(line)
        elif command == 'ads':
            add_shelf(directories)
        elif command == 'ds':
            delete_shelf(directories, documents)
        else:
            print("Неизвестная команда. Повторите ввод или введите 'q' для выхода.")

# запуск программы
if __name__ == "__main__":
    main()
